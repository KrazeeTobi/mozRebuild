<HTML>
<HEAD>
<TITLE>DragSource - Interface (Pure virtual class)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT=0 MARGINWIDTH=0>

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP ROWSPAN=2><IMG
SRC="../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH=600 HEIGHT=58 VSPACE=0 HSPACE=0></TD></TR></TABLE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">

<TR>


<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>



<TD BGCOLOR="#DDDDDD" VALIGN=TOP COLSPAN=2><IMG ALT=""
SRC="../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP><IMG ALT=""
SRC="../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP ALIGN=RIGHT>
</TD>


<TD VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

</TR>


<TR>

<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP COLSPAN=3>

<BR><TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="..//"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../mission.html"> Our Mission</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../about.html"> Who We Are</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../get-involved.html"> Getting Involved</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../community.html"> Community</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../advocacy.html"> Editorials</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../news.html"> What's New</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../newsbot/"> Newsbot</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../development.html"><B> Development</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../roadmap.html"> Roadmap</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../blue-sky/"> Blue Sky</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../projects.html"> Projects</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../status/"> Status</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../tools.html"> Tools</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../products.html"><B> Products</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../source.html"> Source Code</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../binaries.html"> Binaries</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../docs/"> Documentation</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../NPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../bugs/"> Bug Reports</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../quality/"> Quality</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../search.html"><B> Search</B></A></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../feedback.html"><B> Feedback</B></A></TD></TR>
</TABLE><BR>
</TD>


<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP ALIGN=RIGHT>
</TD>


<TD VALIGN=TOP>
<P><BR>




   
   



<br><!--This file created 4/19/99 9:07 AM by Claris Home Page version 3.0 30 Day Trial--><X-CLARIS-WINDOW TOP=44 BOTTOM=730 LEFT=4 RIGHT=534><X-CLARIS-TAGVIEW MODE=minimal>
<h1>
XPToolkit Clipboard</h1>
Written by <a href="mailto:rods@netscape.com">Rod Spears</a>
<br>4/19/99
<h2>
Simple Use cases</h2>

<ul>
<li>
User selects data, copies it to the clipboard</li>

<li>
User pastes from the clipboard</li>
</ul>

<h2>
NGLayout requirements</h2>

<ul>
<li>
No direct requirement</li>
</ul>

<h2>
High Level Design</h2>

<h2>
This is a very preliminary design for clipboard support within NGLayout.</h2>

<h2>
Design goals:</h2>

<ol>
<li>
Simplified, streamline API</li>
</ol>

<h1>

<hr></h1>

<h2>
Clipboard - Interface and Implementation</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>Application-wide clipboard. It is a service that manages a single Transferable
object and grants access to the native clipboard.</td>
</tr>

<tr>
<td>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsIClipboard.h">nsIClipboard.h</a></td>
</tr>
</table>

<h2>
ClipboardOwner - Interface only</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>Objects implementing the ClipboardOwner interface "own" the transferable
object on the application clipboard. When a new object is placed on the
clipboard or the clipboard is cleared externally the owner is notified.</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsIClipboardOwner.h">nsIClipboardOwner.h</a></td>
</tr>
</table>

<h2>
DataFlavor - Interface and Implementation (Cross platform impl.)</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>A simple class that defines a MIME type and a human readable string
for that MIME type. Transferable use this interface/object to identify
the type of data that a Transferable contains or can emit.</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsIDataFlavor.h">nsIDataFlavor.h</a></td>
</tr>
</table>

<h2>
Transferable - Interface</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>A transferable is a platform independent description and implemention
of some piece of data. The data is described by a list of supported DataFlavor
types.
<p>The nsITransferable interface used as a "getter" interface. Transferable
objects must support as a miminum this interface.
<br>&nbsp;</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsITransferable.h">nsITransferable.h</a></td>
</tr>
</table>

<h2>
GenericTransferable - Interface and Implementation (Cross platform impl.)</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>The GenericTransferable is a specific implementation of a transferable.
It implements the nsITransferable interface enabling consumers accessof
its internal data. It also, implements the nsIGenericTransferable interface
that is used to set the data into the transferable. The nsIGenericTransferable
interface also supports FormatConverters. The GenericTransferable is a
multi-purpose transferable that can be used to set up mappings from one
DataFlavor to another. This can be done directly through the class or through
a object implementing the FormatConverter interface.
<p>There may be several different types of transferables within any given
system. The standard implementation is intended to handle Text, XIF, Unicode
and HTML.</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsIGenericTransferable.h">nsIGenericTransferable.h</a></td>
</tr>
</table>

<h2>
FormatConverter - Interface</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>The FormatConverter provides a interface for converting from one type
of DataFlavor to another. Implementations may be created to convert text
to HTML. Image converters may convert from JPEG to PNG.</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/public/nsIFormatConverter.h">nsIFormatConverter.h</a></td>
</tr>
</table>

<h2>
XIFFormatConverter - Implementation (Cross platform impl.)</h2>

<table>
<tr>
<td VALIGN=TOP>
<div align=right><b>Description:&nbsp;</b></div>
</td>

<td>The XIFFormatConverter class supports the conversion of&nbsp; XIF data
to Text, HTML, and AOL Mail formats. It currently does not suport the conversion
of generic data to the XIF format.</td>
</tr>

<tr>
<td VALIGN=TOP>
<div align=right><b>Interface:</b></div>
</td>

<td><a href="http://lxr.mozilla.org/mozilla/source/widget/src/xpwidgets/nsXIFFormatConverter.cpp">nsXIFFormatConverter.cpp</a></td>
</tr>
</table>

<h2>
<font size=+2>Implementation Considerations</font></h2>
<b>Platform</b>
<br>Each platform will need to implement the Clipboard object to expose
the native clipboard and its funcationality via the interfaces described
above.
<br>&nbsp;
<h2>
<font size=+2>How to Place Items on the Clipboard</font></h2>
To place data on the clipboard you must first create an object that supports
the nsITransferable interface, set data into the transferable and then
set it into the clipboard.
<br>&nbsp;
<h4>
How to Put Text onto the Clipboard</h4>
<tt><font color="#000099">&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Get the Clipboard Service</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsIClipboard* clipboard;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsresult rv = nsServiceManager::GetService(kCClipboardCID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIClipboardIID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(nsISupports **)&amp;clipboard);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Create a data flavor to tell the transferable</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // that it
is about to receive Text</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nsCOMPtr&lt;nsIDataFlavor>
flavor;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rv = nsComponentManager::CreateInstance(kCDataFlavorCID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIDataFlavorIID, (void**) getter_AddRefs(flavor));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NS_OK
== rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Initialize data flavor to Text</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
flavor->Init(kTextMime, "Text Format");</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Create a generic transferable for putting
data on the Clipboard</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsCOMPtr&lt;nsIGenericTransferable> genericTrans;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
rv = nsComponentManager::CreateInstance(kCGenericTransferableCID, nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIGenericTransferableIID, (void**) getter_AddRefs(genericTrans));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// The data on the clipboard will be in "Text"
format</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// add the DataFlavor to the generic transferable</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->AddDataFlavor(flavor);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Now add the Text data into the transferable</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#000099">const char * data =
</font><font color="#CC33CC">"I
am text Data";</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->SetTransferData(flavor, data, strlen(data));</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Get the nsITransferable interface from
the GenericTransferable and</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// put the transferable on the clipboard, the clipboard owner is set to
nsnull</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsCOMPtr&lt;nsITransferable> trans = do_QueryInterface(genericTrans);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (trans) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
clipboard->SetData(trans, nsnull);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsServiceManager::ReleaseService(kCClipboardCID,
clipboard);</font></tt>
<br><tt><font color="#000099"></font></tt>&nbsp;
<br>&nbsp;
<h4>
How to Put Content onto the Clipboard</h4>
<tt><font color="#006600">&nbsp; // This code snipet comes from the Presentation
Shell (nsPresShell.cpp)</font></tt>
<br><tt><font color="#006600">&nbsp; // it has access to the document,
so start by getting the current document</font></tt>
<br><tt><font color="#000099">&nbsp; nsCOMPtr&lt;nsIDocument> doc;</font></tt>
<br><tt><font color="#000099">&nbsp; GetDocument(getter_AddRefs(doc));</font></tt>
<br><tt><font color="#000099">&nbsp; if (doc) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Create a buffer for holding the content converted to XIF</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsString buffer;</font></tt>
<p><tt><font color="#006600">&nbsp;&nbsp;&nbsp; // Get the current selection
in the PresShell</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsIDOMSelection* sel =
nsnull;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; GetSelection(&amp;sel);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Ask the document to convert the selection to a XIF encoded string</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp; // This walks through
the content nodes converting their contents to XIF</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp; // If there is no selection
then the clipboard will hold what is basically</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp; // empty content</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if (sel != nsnull) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc->CreateXIF(buffer,sel);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; NS_IF_RELEASE(sel);</font></tt>
<p><tt><font color="#006600">&nbsp;&nbsp;&nbsp; // Get the Clipboard Service</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsIClipboard* clipboard;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsresult rv = nsServiceManager::GetService(kCClipboardCID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIClipboardIID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(nsISupports **)&amp;clipboard);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Create a data flavor to tell the transferable</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // that it
is about to receive XIF</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nsCOMPtr&lt;nsIDataFlavor>
flavor;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rv = nsComponentManager::CreateInstance(kCDataFlavorCID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIDataFlavorIID, (void**) getter_AddRefs(flavor));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NS_OK
== rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Initialize data flavor to XIF</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
flavor->Init(kXIFMime, "XIF");</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Create a transferable for putting data
on the Clipboard</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsCOMPtr&lt;nsIGenericTransferable> genericTrans;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
rv = nsComponentManager::CreateInstance(kCGenericTransferableCID, nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIGenericTransferableIID, (void**) getter_AddRefs(genericTrans));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</font><font color="#006600">/ The data on the clipboard will be in "XIF"
format</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// so give the clipboard transferable a "XIFConverter" for</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// converting from XIF to other formats</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsCOMPtr&lt;nsIFormatConverter> xifConverter;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
rv = nsComponentManager::CreateInstance(kCXIFConverterCID, nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIFormatConverterIID, (void**) getter_AddRefs(xifConverter));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Add the XIF DataFlavor to the transferable</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// this tells the transferable that it can handle receiving the XIF format</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->AddDataFlavor(flavor);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Add the converter for going from XIF to
other formats</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->SetConverter(xifConverter);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Now add the XIF data to the transferable</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->SetTransferData(flavor, buffer.ToNewCString(), buffer.Length());</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</font><font color="#006600">/ put the transferable on the clipboard</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nsCOMPtr&lt;nsITransferable> trans(do_QueryInterface(genericTrans));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (trans) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
clipboard->SetData(trans, nsnull);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nsServiceManager::ReleaseService(kCClipboardCID,
clipboard);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp; }</font></tt>
<br>&nbsp;
<h2>
Getting Items off of the Clipboard</h2>

<h4>
How to Get Text off of the Clipboard</h4>
<tt><font color="#000099">&nbsp;
</font><font color="#006600">// Get Clipboard
Service</font></tt>
<br><tt><font color="#000099">&nbsp; nsIClipboard* clipboard;</font></tt>
<br><tt><font color="#000099">&nbsp; nsresult rv = nsServiceManager::GetService(kCClipboardCID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIClipboardIID,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(nsISupports **)&amp;clipboard);</font></tt>
<p><tt><font color="#006600">&nbsp; // Create generic Transferable for
getting the data</font></tt>
<br><tt><font color="#000099">&nbsp; nsCOMPtr&lt;nsIGenericTransferable>
genericTrans;</font></tt>
<br><tt><font color="#000099">&nbsp; rv = nsComponentManager::CreateInstance(kCGenericTransferableCID,
nsnull,</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIGenericTransferableIID, (void**) getter_AddRefs(genericTrans));</font></tt>
<br><tt><font color="#000099">&nbsp; if (NS_OK == rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Get the nsITransferable interface for getting the data from the clipboard</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; nsCOMPtr&lt;nsITransferable>
trans(do_QueryInterface(genericTrans));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; if (trans) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nsCOMPtr&lt;nsIDataFlavor>
flavor;</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#006600">//
Create the desired DataFlavor for the type of data we want to get out of
the transferable</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rv = nsComponentManager::CreateInstance(kCDataFlavorCID,
nsnull,&nbsp;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
kIDataFlavorIID, (void**) getter_AddRefs(flavor));</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NS_OK
== rv) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Initialize the DataFlavor and set it into
the GenericTransferable</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
flavor->Init(kTextMime, "Text");</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
genericTrans->AddDataFlavor(flavor);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Get the Data from the clipboard</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
clipboard->GetData(trans);</font></tt>
<p><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Now we ask the transferable for the data</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// it still owns the data, we just have a pointer to it.</font></tt>
<br><tt><font color="#006600">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// If it can't support a "text" output of the data the call will fail</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
char *str = 0;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PRUint32 len;</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (NS_OK == trans->GetTransferData(flavor, (void **)&amp;str, &amp;len))
{</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// Make adjustments for null terminated strings</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (str &amp;&amp; len > 0) {</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#006600">// stuffToPaste is ready for insertion into
the content</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
stuffToPaste.SetString(str, len);</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp;&nbsp;&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp; }</font></tt>
<br><tt><font color="#000099">&nbsp; nsServiceManager::ReleaseService(kCClipboardCID,
clipboard);</font></tt>
<br>&nbsp;
<h2>
Owners</h2>
NGLayout-only work (<i><a href="mailto:joki@netscape.com">Tom Pixley</a></i>)
<br>XP classes &amp; Win32 (<i><a href="mailto:rods@netscape.com">Rod Spears</a></i>)
<br>MAC (<i><a href="mailto:pinkerton@netscape.com">Mike Pinkerton</a></i>)
<br>Unix (<i><a href="mailto:mcafee@netscape.com">Chris McAfee</a></i>)
<h2>
Dependencies</h2>
TBD</td>





<P><BR>
</TD>


<TD VALIGN=TOP ALIGN=RIGHT>
</TD>


<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

</TR>


<TR>


<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM COLSPAN=2><IMG ALT=""
SRC="../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=BOTTOM COLSPAN=2><IMG ALT=""
SRC="../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>
</TR>

<TR>

<TD BGCOLOR="#000000" COLSPAN=6><BR></TD>

<TD BGCOLOR="#000000" VALIGN=TOP>

<FONT COLOR="#AAAAAA" SIZE="-1">
Copyright &copy; 1998 The Mozilla Organization.
</FONT>

</TD>

<TD BGCOLOR="#000000" COLSPAN=2><BR></TD>
</TR>

</TABLE>
<P>
</BODY>
</HTML>
