<HTML>
<HEAD>
<TITLE>New Layout: Forms</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT=0 MARGINWIDTH=0>

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP ROWSPAN=2><IMG
SRC="../../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH=600 HEIGHT=58 VSPACE=0 HSPACE=0></TD></TR></TABLE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR>


<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=TOP><IMG ALT=""
SRC="../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ROWSPAN=2>

<BR><TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../..//"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../mission.html"> Our Mission</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../about.html"> Who We Are</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../get-involved.html"> Getting Involved</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../community.html"> Community</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../advocacy.html"> Editorials</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../news.html"> What's New</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../development.html"><B> Development</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../blue-sky/"> Blue Sky</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../projects.html"> Projects</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../source-code.html"><B> Source Code</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../source.html"> Getting It</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../docs/"> Documentation</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../NPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../bugs/"> Bugs</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../search"><B> Search</B></A></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../feedback.html"><B> Feedback</B></A></TD></TR>
</TABLE><BR>

</TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=TOP><IMG ALT=""
SRC="../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP ROWSPAN=2>
<P><BR>






<HR><h2>New Layout: Forms</h2>
Author: <A HREF="mailto:karnaze@netscape.com">Chris
Karnaze</A></U>
<BR>Updated: 1 May 1998
<BR>
<HR>
<BR>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Overview</B></TD>
</TR>
</TABLE>

<BR>Forms consists of the html parts
that make up a form and a manager that coordinates activities among those
parts. The html parts (aka form controls) have graphical representations
such as buttons, checkboxes, pull down lists,
radio butons etc. The manager is primarily responsible for submitting the
data that the user enters into the controls to a server for processing.
The manager and controls implement the functionality of the html tags &lt;form>,
&lt;input>, &lt;label>, &lt;button>, &lt;select>, &lt;option>, &lt;optgroup>,
&lt;textarea>, &lt;isindex>, &lt;label>, &lt;fieldset>, &lt;legend>.

<P>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Major Components</B></TD>
</TR>
</TABLE>
The two major components, the form controls
and the form manager, implement the external public interfaces <I>nsIFormControl</I>
and <I>nsIFormManager</I>. <I>nsIFormControl</I> specifies the setting/getting
of an nsIFormManager, a name, and values; implementations
of nsIFormControl will most likely also implement nsIContent, since currently,
nsIFormControl does not derive from nsIContent. <I>nsIFormManager</I>
specifies adding, removing, retrieving nsIFormControls plus callback methods
for events triggered by controls such as reset, submit, and user return.
It also provides the setting/getting of attributes.
One of the goals of these interfaces
is to allow new implementations of new or existing controls to work with
an existing form manager (and conversely to allow a new implementation
of a form manager to work with existing controls).

<P>Form controls and the form manager
interact with other modules in a number of ways. The html content sink
creates form controls and forms managers as html tags are interpreted;
the form control factory functions are declared in the include file nsHTMLForms.
The layout system treats form controls as normal content, and it is the
responsiblity of form controls to give their size, render, and respond
to mouse/keyboard events. Rendering and handling evetns involves the view
system together with the widget library.

<P>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Implementation</B></TD>
</TR>
</TABLE>

<BR>The form manager has a single class
implementation, nsForm. It has three primary tasks (1) respond to a submit
button press and submit the control data to a server, (2) respond to a
reset button press and reset all of the controls to their initial values,
and (3) manage radio button groups so that only one button in the group
is active at any given time.

<P>Each form control has both a <I>content</I>
and <I>frame</I> representation (as most html parts do). In addition, most
form control frames have their own view which is a widget from the cross-platform
widget library. The exceptions include hidden elements and controls which
use images instead of widgets. The base class, nsInput, provides common
functionality for content, while nsInputFrame servers a similar purpose
for frames.

<P><B>Content</B>

<P>nsInput adds new major behavior (beyond
its base class, nsHTMLContainer) by defining the following virtual methods:
GetNumValues, GetNamesValues, IsHidden, Reset. GetNamesValues returns the
name value pairs that the form manager will submit. Reset sets the associated
widget to its initial state.

<P>nsInput has derivatives nsInputButton,
nsInputCheckbox, nsInputFile, nsInputRadio, nsInputText, nsSelect, nsOption,
nsLabel, nsFieldset, nsLegend. In many cases there is not a one to one
correspondence between an html tag (or tag with type attribute) and an
nsInput derivative. For example, &lt;button>, &lt;input type=hidden> and
&lt;input type=image> are handled by nsInputButton and &lt;input type=text>,
&lt;input type=password>, &lt;textarea> are handled by nsInputText.

<P><B>Frame/View/Widget</B>

<P>nsInputFrame adds new behavior (beyond
its base class, nsLeafFrame) by defining the following virtual methods:
<I>MouseClicked</I>, <I>GetWidgetInitData</I>, <I>PostCreateWidget</I>
and the following non-virtual methods <I>CalculateSize</I>, <I>GetTextSize</I>,
<I>GetStyleSize</I>. <I>MouseClicked</I> allows derivatives to do additional
processing if necessary; for example, a submit button will notify the form
manager to submit data. <I>GetWidgetInitData</I> gathers data which the
view system will use to initialize a widget. <I>PostCreateWidget</I> allows
for processing after the widget is created; for example, initial values
can be used to set the widget to the appropriate state. <I>CalculateSize
</I>is a static method that determines the size of a control based on CSS
settings, local size attribues, attribute values that may affect size,
and default values. It is general enough to be used for nearly all of the
controls. <I>GetTextSize</I> calculates the size of a string based on CSS.

<P>nsInputFrame has derivatives analogous
to nsInput, including: nsInputButtonFrame, nsInputCheckboxFrame, nsInputFileFrame,
nsInputRadioFrame, nsInputTextFrame, nsSelectFrame, nsOptionFrame, nsLabelFrame,
nsFieldsetFrame, nsLegendFrame. Unlike nsInput, however, not all controls
use an nsInputFrame derivative. For example, a &lt;input type=hidden> control
uses nsFrame as a base class and takes the default dimensions (0,0).
<BR>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Dependencies</B></TD>
</TR>
</TABLE>

<BR>Forms are dependent on many other
modules including xpcom, netlib, layout, style, gfx, view, widget, dom/javascript.

<P>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Roadmap</B></TD>
</TR>
</TABLE>

<BR>In May, most of html 3.2 features
will be completed except for internationalization and javascript support.
There will be a break in the schedule during June and July to allow dependencies
to catch up. In August/September, the remaining areas will be completed.
Other integration changes due to dependencies will likely continue beyond
this time.
<BR>
<TABLE COLS=1 WIDTH="80%" BGCOLOR="#FFFFCC" >
<TR>
<TD><B>Known Bugs</B></TD>
</TR>
</TABLE>

<BR>There are no know bugs in Forms,
but there are bugs in dependent modules which affect Forms.
<BR>




<P><BR>
</TD>


<TD VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

</TR>
<TR>


<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>
</TR>

<TR>

<TD BGCOLOR="#000000" COLSPAN=6><BR></TD>

<TD BGCOLOR="#000000" VALIGN=TOP>

<FONT COLOR="#AAAAAA" SIZE="-1">
Copyright &copy; 1998 Netscape Communications Corporation.
</FONT>
</FONT>
</TD>

<TD BGCOLOR="#000000" COLSPAN=2><BR></TD>
</TR>

</TABLE>
<P>
</BODY>
</HTML>
