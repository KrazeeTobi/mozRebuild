<HTML>
<HEAD>
<TITLE>Autoconf for Classic Mozilla</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT="0" MARGINWIDTH="0">

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" ALT="" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP><IMG
SRC="../../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH="600" HEIGHT="58" VSPACE="0" HSPACE="0"></TD></TR></TABLE>

<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">


<TR>


<TD VALIGN="TOP" >
<TABLE BORDER="0" ><TR><TD BGCOLOR="#000000" VALIGN="TOP">
<TABLE BORDER="0" CELLSPACING="3"><TR><TD BGCOLOR="#DDDDDD" VALIGN="TOP">
<TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD NOWRAP COLSPAN=2><A HREF="../.././"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../mozorg.html"> At A Glance</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../feedback.html"> Feedback</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../get-involved.html"> Get Involved</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../community.html"> Newsgroups</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../MPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://www.mozilla.org/newsbot/"> Newsbot</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../docs/"><B> Developer Docs</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../roadmap.html"> Roadmap</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../projects/"> Projects</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../ports/"> Ports</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../hacking/"> Hacking</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../source.html"> Get the Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../build/"> Build It</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../quality/"><B> Testing</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../binaries.html"> Download</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../bugs/"> Bugzilla</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../quality/bug-writing-guidelines.html"> Bug Writing</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../tools.html"><B> Tools</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://lxr.mozilla.org/seamonkey/"> View Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://tinderbox.mozilla.org/showbuilds.cgi?tree=SeaMonkey"> Tree Status</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://cvs-mirror.mozilla.org/webtools/bonsai/cvsquery.cgi?treeid=default&amp;module=SeaMonkeyAll&amp;branch=HEAD&amp;branchtype=match&amp;dir=&amp;file=&amp;filetype=match&amp;who=&amp;whotype=match&amp;sortby=Date&amp;hours=2&amp;date=day&amp;mindate=&amp;maxdate=&amp;cvsroot=%2Fcvsroot"> New Checkins</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://bugzilla.mozilla.org/"> Submit A Bug</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../faq.html"><B> FAQ</B></A></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="http://www.mozilla.org/search.html"><B> Search</B></A></TD></TR>
</TABLE>
</TD></TR></TABLE>
</TD></TR></TABLE>
</TD>


<TD VALIGN="TOP">



<font size="6">
<center>Autoconf for Classic Mozilla<br>
<font size="2">Last updated: <i>1998/11/13</i>
</center>
<hr>
<font size="3">
<P>
<h2>Classic Mozilla Source is Obsolete</h2>
The classic Mozilla source has been obsoleted.  The recommended way of building  Mozilla is to use the <a href="http://www.mozilla.org/nglayout/">next generation layout engine</a>.  The autoconf build instructions for the new source tree is available <a href="./">here</a>.  These instructions are provided mainly as a convenience for those who want something that actually renders a page.
<P>
See the <a href="http://cvs-mirror.mozilla.org/webtools/bonsai/cvsquery.cgi?module=MozillaSource&branch=AUTOCONF_1_0&branchtype=match&dir=&file=&filetype=match&who=&whotype=match&sortby=Date&hours=2&date=all&mindate=&maxdate=&cvsroot=%2Fcvsroot">AUTOCONF_1_0 branch</a> for the list of initial changes.<br>
<P>
<h2>News</h2>
1998/08/19, autoconf support is in the main <a href="http://www.mozilla.org/cvs.html">Mozilla CVS</a> tree.<br>
1998/09/04, the release tarballs include autoconf support.<br>
1998/09/09, NSPR is no longer built with autoconf.  Currently, there is a kludge to make it use the old build system.<br>
1998/09/10, there is a <a href="http://tinderbox.seawood.org/tinderbox/showbuilds.cgi?tree=MozillaAutoconf">MozillaAutoconf</a> <a href="http://www.mozilla.org/tinderbox.html">Tinderbox</a>. Use it to find out the build state of the tree and who is responsible for it breaking.<br>
1998/09/25, --enable-nspr has been removed. Both QTFE and GNOMEFE are in the main cvs tree and have autoconf support.<br>
1998/10/02, NSPR build kludge has been removed.  You must build NSPR separately to use autoconf.<br>
1998/10/05, the MozillaAutoconf tinderbox is more or less defunct.  The builds have moved to the <a href="http://cvs-mirror.mozilla.org/webtools/tinderbox/showbuilds.cgi?tree=Mozilla-External">Mozilla-External</a> tinderbox.<br>
1998/10/19, some major autoconf interface changes were preannounced.<br>
1998/10/23, the following changes have been applied:
<dd>System jpeg & png libraries are used if they are more recent
<dd>System zlib library is used by default
<dd>Separate variables where added for jpeg, png, zlib & X libs and includes.
<br>
1998/10/25, changed --enable-pthreads to --with-pthreads.<br>
1998/10/26, classic Mozilla source moved to MozillaSourceClassic_19981026_BRANCH branch.<br>
<P>
<h2>Notes:</h2>
You will need autoconf 2.12 (which requires GNU m4) or higher to use autoconf with mozilla.<br>
If building under UnixWare, you will need to specify the location of the X headers and libs via <I>--x-includes=/usr/X/include</I> and <I>--x-libraries=/usr/X/lib</I> as autoconf apparently does not check these automatically.
<P>
Misc files:
<li> <a href="moz-pngheader.diff">patch for pngconf.h</a> Fixes problem with linux and &lt;setjmp.h&gt; in png 1.0.2.
<P>
Building in the srcdir is disallowed as it causes problems if you want to later build in a subdir for a different configuration.  You should create a subdirectory, obj-`./config.guess`.  This is where you should actually run the build.  From this directory, run ../configure.
<P>
<h2>Building</h2>
You do <strong>NOT</strong> need to set the old build's environment variables when using autoconf.  In fact, you should unset them to avoid running into problems.<br>
<P>
<h4>To build the classic Mozilla source:</h4>
<P>
First you will need a local copy of the source tree via
<pre>
cvs -z3 -d :pserver:anonymous@cvs-mirror.mozilla.org:/cvsroot \
    co -r MozillaSourceClassic_19981026_BRANCH MozillaSource 
cd mozilla
</pre>
or
<pre>
tar -xvBpzf ~/mozilla-19980904.tar.gz
cd mozilla
</pre>
<P>
If NSPR is not already installed on your system, you need to install NSPR.  Unfortunately, there is no clean way to do this.  Here is an example of the commands used to install NSPR: (YMMV) <br>
<pre>
gmake -C nsprpub DIST=/usr/local/nspr NSDISTMODE=copy NS_USE_GCC=1 \
    MOZILLA_CLIENT=1 NO_MDUPDATE=1 NS_USE_NATIVE= USE_PTHREADS= export
</pre>
If you are installing the NSPR shared libs (on by default), make sure that you add the location of the shared libs to your LD_LIBRARY_PATH before running configure.
<P>
Then you need to build autoconf and tell it where to find NSPR if it is not installed in a standard place.
<pre>
autoconf
mkdir obj-`./build/autoconf/config.guess`
cd obj-`./build/autoconf/config.guess`
../configure --with-nspr=/usr/local/nspr
gmake depend
gmake
</pre>
<P>
<h2>Options</h2>
Each --with option has a corresponding --without option and vice-versa.<br>
Each --enable option has a corresponding --disable option and vice-versa.<br>
The following mozilla options supported by configure:<br>
<P>
<TABLE>
<TR><TD VALIGN=TOP>--with-jpeg=<I>DIR</I>
  </TD><TD VALIGN=TOP>Look for JPEG headers and libraries under DIR</TD></TR>
<TR><TD VALIGN=TOP>--with-png=<I>DIR</I>
  </TD><TD VALIGN=TOP>Look for PNG headers and libraries under DIR</TD></TR>
<TR><TD VALIGN=TOP>--with-zlib=<I>DIR</I>
  </TD><TD VALIGN=TOP>Look for ZLIB headers and libraries under DIR</TD></TR>
<TR><TD VALIGN=TOP>--with-nspr=<I>DIR</I>
  </TD><TD VALIGN=TOP>Look for NSPR headers and libraries under DIR</TD></TR>
<TR><TD VALIGN=TOP>--with-pthreads
  </TD><TD VALIGN=TOP>Use native pthreads support with NSPR</TD></TR>
<TR><TD VALIGN=TOP>--enable-fe=<I>FE1,FE2</I>
  </TD><TD VALIGN=TOP>Use the FE frontends and check dependencies</TD></TR>
<TR><TD VALIGN=TOP>--enable-homedir=<I>val</I>
  </TD><TD VALIGN=TOP>Set mozilla user dir to val</TD></TR>
<TR><TD VALIGN=TOP>--enable-min-shared
  </TD><TD VALIGN=TOP>Enable use of minimal internal dynamic libs</TD></TR>
<TR><TD VALIGN=TOP>--enable-crypto
  </TD><TD VALIGN=TOP>Enable use of SSL for https (untested)</TD></TR>
<TR><TD VALIGN=TOP>--enable-netcast
  </TD><TD VALIGN=TOP>Enable use of netcast (untested)</TD></TR>
<TR><TD VALIGN=TOP>--enable-java
  </TD><TD VALIGN=TOP>Enable java support (untested)</TD></TR>
<TR><TD VALIGN=TOP>--enable-oji
  </TD><TD VALIGN=TOP>Enable use of Open JVM Interface</TD></TR>
<TR><TD VALIGN=TOP>--enable-debug
  </TD><TD VALIGN=TOP>Add mozilla debug options to CFLAGS</TD></TR>
<TR><TD VALIGN=TOP>--enable-profile
  </TD><TD VALIGN=TOP>Enable mozilla profiling (Solaris only)</TD></TR>
<TR><TD VALIGN=TOP>--enable-mailnews
  </TD><TD VALIGN=TOP>Enable mail & news features (broken)</TD></TR>
<TR><TD VALIGN=TOP>--enable-editor
  </TD><TD VALIGN=TOP>Enable composer</TD></TR>
<TR><TD VALIGN=TOP>--enable-dom
  </TD><TD VALIGN=TOP>Enable Level-1 Document Object Model support</TD></TR>
<TR><TD VALIGN=TOP>--enable-mail-compose
  </TD><TD VALIGN=TOP>Enable old Messenger mail composer</TD></TR>
<TR><TD VALIGN=TOP>--enable-tests
  </TD><TD VALIGN=TOP>Enable test stubs</TD></TR>
<TR><TD VALIGN=TOP>--enable-ldap
  </TD><TD VALIGN=TOP>Enable LDAP support</TD></TR>
<TR><TD VALIGN=TOP>--disable-asserts
  </TD><TD VALIGN=TOP>Disable error asserts during debugging</TD></TR>
<TR><TD VALIGN=TOP>--disable-async-dns
  </TD><TD VALIGN=TOP>Disable separate dns thread</TD></TR>
<TR><TD VALIGN=TOP>--disable-shared
  </TD><TD VALIGN=TOP>Disable building of internal shared libs</TD></TR>
<TR><TD VALIGN=TOP>--disable-static
  </TD><TD VALIGN=TOP>Disable building of internal static libs (broken)</TD></TR>
</TABLE>
<font size=3>





</TD>

</TR>
<TR>

<TD COLSPAN="2" ALIGN="RIGHT" VALIGN="TOP">
<FONT SIZE="-1">
Copyright &copy; 1998-1999 The Mozilla Organization.
<BR>
<A HREF="http://www.mozilla.org/webtools/bonsai/cvslog.cgi?file=mozilla-org/html/projects/autoconf/classic.html&amp;rev=&amp;root=/cvsroot/">Last modified November 13,  1998</A>.
</FONT>
</TD>
</TR>

</TABLE>
</BODY>
</HTML>
