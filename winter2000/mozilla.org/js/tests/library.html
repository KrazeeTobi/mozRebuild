<HTML>
<HEAD>
<TITLE>JavaScript Test Library</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT="0" MARGINWIDTH="0">

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" ALT="" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP><IMG
SRC="../../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH="600" HEIGHT="58" VSPACE="0" HSPACE="0"></TD></TR></TABLE>

<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">


<TR>


<TD VALIGN="TOP" >
<TABLE BORDER="0" ><TR><TD BGCOLOR="#000000" VALIGN="TOP">
<TABLE BORDER="0" CELLSPACING="3"><TR><TD BGCOLOR="#DDDDDD" VALIGN="TOP">
<TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD NOWRAP COLSPAN=2><A HREF="../.././"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../mozorg.html"> At A Glance</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../feedback.html"> Feedback</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../get-involved.html"> Get Involved</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../community.html"> Newsgroups</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../MPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://www.mozilla.org/newsbot/"> Newsbot</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../docs/"><B> Developer Docs</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../roadmap.html"> Roadmap</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../projects/"> Projects</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../ports/"> Ports</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../hacking/"> Hacking</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../source.html"> Get the Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../build/"> Build It</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../quality/"><B> Testing</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../binaries.html"> Download</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../bugs/"> Bugzilla</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../../quality/bug-writing-guidelines.html"> Bug Writing</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../tools.html"><B> Tools</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://lxr.mozilla.org/seamonkey/"> View Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://tinderbox.mozilla.org/showbuilds.cgi?tree=SeaMonkey"> Tree Status</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://cvs-mirror.mozilla.org/webtools/bonsai/cvsquery.cgi?treeid=default&amp;module=SeaMonkeyAll&amp;branch=HEAD&amp;branchtype=match&amp;dir=&amp;file=&amp;filetype=match&amp;who=&amp;whotype=match&amp;sortby=Date&amp;hours=2&amp;date=day&amp;mindate=&amp;maxdate=&amp;cvsroot=%2Fcvsroot"> New Checkins</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://bugzilla.mozilla.org/"> Submit A Bug</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../../faq.html"><B> FAQ</B></A></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="http://www.mozilla.org/search.html"><B> Search</B></A></TD></TR>
</TABLE>
</TD></TR></TABLE>
</TD></TR></TABLE>
</TD>


<TD VALIGN="TOP">






    <h1>JavaScript Test Library</h1>
    
    <p>
      The <a href="http://www.mozilla.org/js/">JavaScript</a> team maintains a
      library of tests that are based on the ECMA-262 standard for
      web scripting languages and other documentation for JavaScript.
    <p>
      If you find a bug in the core JavaScript engine, you can now contribute a
      test to our library.  Your tests will be used to reproduce bugs, verify bug
      fixes, prevent regressions, and improve the stability of the JavaScript
      engine.
    <p>
      If you are contributing code to the JavaScript engine, you can use
      the tests to verify that the engine still works correctly before checking
      in.  The test driver is designed to be easy to use in a unit testing
      situation.  You can execute just a single test, or a small subset of tests,
      with results displayed directly to the console.  It may actually make your
      unit testing process easier to use the same test driver.  In addition,
      your unit tests can be expanded by QA into more robust cases and included
      in the test suite.
    
    <h2>What's covered by the JavaScript tests?</h2>

    <p>
      The JavaScript tests cover the functionality of the core JavaScript engine.
      This includes the following JavaScript objects:
    <center>
      <table>
        <tr>
          <td valign="top">
            <ul>
              <li>Arrays
              <li>Booleans
              <li>Dates
              <li>Functions
            </ul>
          </td>
          <td valign="top">
            <ul>
              <li>Global Object
              <li>Math
              <li>Numbers
              <li>Objects
            </ul>
          </td>
          <td valign="top">
            <ul>
              <li>Regular Expressions
              <li>Strings
            </ul>
          </td>
        </tr>
      </table>
    </center>
    <p>
      Additionally, the JavaScript tests cover parsing, lexical conventions,
      expressions, statements, type conversion, and exception handling.  See the
      current standard
      (<a href="ftp://ftp.ecma.ch/ecma-st/e262-pdf.pdf">ECMA 262</a>),
      or the current working draft (on the
      <a href="http://www.mozilla.org/js/language/futures.html">JavaScript futures page</a>)
      of the revised standard if you have questions about what is part of core
      JavaScript.
    <p>
      We also have tests for
      <a href="http://www.mozilla.org/oji">LiveConnect</a>,
      the bridge code which allows JavaScript and Java to function as peer
      environments.  It should be noted that LiveConnect is not considered part
      of <i>Core</i> JavaScript, and in fact has it's own
      <a href="http://bugzilla.mozilla.org/describecomponents.cgi?product=Browser">BugZilla Component</a>.
      When reporting bugs in LiveConnect, be sure to use the proper component.
    <p>
      <a name="PLEASE"></a>
      <b>PLEASE, Please, please</b> be sure to understand that the 
      <b>JavaScript Engine</b> itself has nothing to do
      with the web browser.  JavaScript is <i>embedded</i> in most web browsers,
      but it can be 
      <a href="http://lxr.mozilla.org/mozilla/source/js/src/README.html#JSAPI">embedded</a>
      in most any host application.  Most of the bugs reported against the
      <b>JavaScript Engine</b> component in BugZilla are actually embedding
      issues.  The most common mistake is to file a DOM or event handling issue,
      such as trouble getting to a property of the <code>window</code> object or
      trouble catching key events to the JavaScript engine.  While your bug
      will eventually be reclassified into the correct component, getting
      the component right from the start helps developers to swiftly fix the
      problem.

    <h2>What's not covered by the JavaScript tests?</h2>
    <p>
      Tests must <b>not</b> refer to any objects that are not part of core
      JavaScript.  This is because the tests are run not only against the
      JavaScript engine in the browser, but also against the stand-alone
      JavaScript engines.
    <p>
      Because the tests are not always run in the browser, it is important that
      you not refer to any objects that are part of the browser or DOM.  For 
      example, you must not refer to the following objects, or methods or
      properties of the following objects:
    <ul>
      <li>navigator
      <li>window
      <li>document
      <li>layer
      <li>form elements
    </ul>
    
    <p>
      If you would like to write tests that cover DOM objects, talk to the
      people at 
      <a href="news://news.mozilla.org/netscape.public.mozilla.qa.general">
        netscape.public.mozilla.qa.general</a>, or see the
      <a href="http://www.mozilla.org/quality">quality assurance group's page
      </a>. You should also check out the
      <a href="http://www.mozilla.org/newlayout/">NGLayout project</a>'s page on
      <a href="http://www.mozilla.org/newlayout/getinvolved.html">how you can
        help</a>.

    <h2>Which areas should I write tests for?</h2>
    <p>
      If you would like to contribute tests to the library, please contact
      <a href="mailto:rginda@netscape.com?subject=I'd like to contribute to the JavaScript Test Library!">the coordinator</a>.

    <p>
      We would really appreciate it if you wrote tests that demonstrate any bugs
      you find in the JavaScript engine.  Providing a test will make sure that
      we can reproduce the bug, and will make sure that there won't be
      regressions.

    <h2>Where are the JavaScript tests?</h2>
    <p>
      The tests that are currently available on mozilla.org are checked into
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/">mozilla/js/tests</a>.
      You must check them out explicitly as they are not part of the SeaMonkeyAll
      partition. (Where the bulk of the Mozilla source code is.)  If you already
      have an existing source tree, getting the tests is a easy as:<br>
      <br>
      <code>
        cd mozilla/js<br>
        cvs up -d tests<br>
      </code>
    <p>
      If you do not already have a Mozilla source tree, see the instructions on
      <a href="http://www.mozilla.org/cvs.html">checking out source code</a>
      for information on how to set up your CVSROOT and log in.

    <h2>How do I write a JavaScript test?</h2>
    <p>
      The 
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/README-jsDriver.html">new test driver</a>,
      <b>jsDriver.pl</b>,
      allows for a simpler test case layout, while still maintaining
      compatibility
      with the previous driver.  Both test drivers expect the tests to be laid
      out in a directory structure that
      is exactly three levels deep.  Currently, <code>mozilla/js/tests</code>
      is the root of all tests.  Under the root, you will find the
      <b>Test suite</b> directories, such as <code>js1_1</code>, 
      <code>ecma</code>, <code>ecma_2</code>, and <code>ecma_3</code>
      (the <code>src</code> directory contains Java classes used in the
      LiveConnect tests, not actual test suites.)  Each <b>Test Suite</b> has
      a collection of <b>Test Categories</b> underneath it.  Test cases are
      placed in the <b>Test Category</b> directory, in a .js file.
    <p>
      To the jsDriver.pl, <b>shell.js</b> is a magic file.  If it exists in
      either the <b>Test Suite</b> or the <b>Test Category</b> directory,
      it is loaded before the testcase executes.  If it exists in both 
      directories, the <b>Test Suite</b> version is loaded before the
      <b>Test Category</b>
      version.  In this way, common functions can be shared among testcases.
      Older suites (currently all of them except ecma_3) have a
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/js1_1/shell.js">rather bloated shell.js</a>
      file for historical reasons.  The new
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/ecma_3/shell.js">ecma_3 suite's shell.js</a>
      is trimmed to just a few failure reporting routines which your testcases
      may use.
    <p>
      The bulk of the tests follow the format described in the 
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/template.js">template.js file</a>.
      It consists of a brief comment describing what the test is about, some
      variable initialization, and some test cases.
    <p>
      Newer testcases are even simpler, because they use the smaller 
      <b>shell.js</b>.  Look at the testcases in 
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/ecma_3/Exceptions/">ecma_3/Exceptions/</a>
      for an example of how to write testcases under this <b>shell.js</b>
    <p>
      Each test case has three parts:  a string representation of what you are
      testing, the expected result, and the actual
      result.  You can write functions to generate the test cases, or you can
      hard-code all the test data.  The structure of the test is up to you.
      Check out some of the
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/">existing tests</a>
      for examples.
    <p>
      Testcases with filenames ending in -n, as in
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/ecma_3/Exceptions/catchguard-001-n.js">catchguard-001-n.js</a>, signify to the test driver that
      they are <b>expected</b> to fail.  That is, an exit code of 3 should be
      considered success, anything else is a failure.  (Normally exit code 0
      implies success.)  You can specify an arbitrary exit code as the success
      code by outputting a line of the format <code>EXPECT EXIT: <i>n</i></code>
      where <code><i>n</i></code> is the code to expect.  You can force your
      testcase to exit with a specific exit code with the
      <code>quit(<i>n</i>)</code> JavaScript shell function.
      See the
      <a href="http://lxr.mozilla.org/mozilla/source/js/tests/README-jsDriver.html">man page for jsDriver.pl</a>
      for more information.


    <h2>How do I run the JavaScript tests?</h2>
    <ul>
      <li>
        First, retrieve the
        <a href="http://lxr.mozilla.org/mozilla/source/js/tests/">mozilla/js/tests</a>
        directory.   You can download this from 
        <a href="ftp://ftp.mozilla.org/pub/js">ftp.mozilla.org</a>
        or one of the 
        <a href="file:/home/rginda/HTML/mozilla-org/html/mirrors.html">mirrors</a>
        in a file called <b>pub/js/js-tests-&lt;date-stamp&gt;.tar.gz</b>,
        or you can check it out directly from
        <a href="http://www.mozilla.org/cvs.html">cvs</a>
        If you have a complete Mozilla source tree, change to the
        <code>mozilla/js</code> directory, and issue the command
        <code>cvs up -d tests</code> to retrieve the <code>tests</code> 
        directory from cvs.
      <li>
        Second, read the 
        <a href="http://lxr.mozilla.org/mozilla/source/js/tests/README-jsDriver.html">man page for jsDriver.pl</a>
      <li>
        Third, make sure you have the
        <a href="http://search.cpan.org/search?module=Getopt::Mixed">Getopt::Mixed</a>
        Perl module installed.
      <li>
        Fourth, run <b>jsDriver.pl</b> as described in the man page.
      <li>
        Finally, 
        <a href="mailto:rginda@netscape.com?subject=JS Test Results">Submit</a>
        your results to the test coordinator, the
        <a href="news:netscape.public.mozilla.jseng">JS Engine newsgroup</a>, or
        file bugs directly in
        <a href="http://bugzilla.mozilla.org/">Bugzilla</a>.
   </ul>
    
    <h2>Resources</h2>
    <ul>
      <li>
        <a href="http://lxr.mozilla.org/mozilla/source/js/tests">Test source</a>
      <li>
        <a href="news://news.mozilla.org/netscape.public.mozilla.jseng">JavaScript newsgroup</a>
      <li>
        <a href="http://www.mozilla.org/js">JavaScript page</a>
      <li>
        <a href="http://www.mozilla.org/js/language/futures.html">JS Futures</a>
        page, including links to the newest ECMA262 revision.
      <li>
        <a href="http://lxr.mozilla.org/mozilla/source/js/tests/README-jsDriver.html">man page for jsDriver.pl</a>
      <li>
        <a href="http://www.mozilla.org/rhino/">Rhino homepage</a>
      <li>
        <a href="http://www.mozilla.org/js/">Spidermonkey homepage</a>
    </ul>

    <hr>

    <p>
      <i><a href="mailto:rginda@netscape.com">Robert Ginda</a></i>

  



</TD>

</TR>
<TR>

<TD COLSPAN="2" ALIGN="RIGHT" VALIGN="TOP">
<FONT SIZE="-1">
Copyright &copy; 1998-2000 The Mozilla Organization.
<BR>
<A HREF="http://www.mozilla.org/webtools/bonsai/cvslog.cgi?file=mozilla-org/html/js/tests/library.html&amp;rev=&amp;root=/cvsroot/">Last modified December 17,  1999</A>.
</FONT>
</TD>
</TR>

</TABLE>
</BODY>
</HTML>
