<HTML>
<HEAD>
<TITLE>LiveConnect Exceptions</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT=0 MARGINWIDTH=0>

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP ROWSPAN=2><IMG
SRC="../../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH=600 HEIGHT=58 VSPACE=0 HSPACE=0></TD></TR></TABLE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR>


<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=TOP><IMG ALT=""
SRC="../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ROWSPAN=2>

<BR><TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../..//"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../mission.html"> Our Mission</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../about.html"> Who We Are</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../get-involved.html"> Getting Involved</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../community.html"> Community</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../advocacy.html"> Editorials</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../news.html"> What's New</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../development.html"><B> Development</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../roadmap.html"> Roadmap</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../blue-sky/"> Blue Sky</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../projects.html"> Projects</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../status/"> Status</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../tools.html"> Tools</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../products.html"><B> Products</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../source.html"> Source Code</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../binaries.html"> Binaries</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../docs/"> Documentation</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../NPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../bugs/"> Bug Reports</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../search"><B> Search</B></A></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../feedback.html"><B> Feedback</B></A></TD></TR>
</TABLE><BR>

</TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=TOP><IMG ALT=""
SRC="../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP ROWSPAN=2>
<P><BR>

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

  
  

      

    <p align="LEFT"><b><font size="+3">LiveConnect Exceptions</font><br>
	by Chris Cooper 
	&lt<A HREF="mailto:coop@netscape.com">coop@netscape.com</A>&gt;
      </b></p>

    <p>LiveConnect enables communication between JavaScript and Java applets 
      in a page and between JavaScript and plug-ins loaded on a page. However,
      until now, Java and JavaScript were unable to catch exceptions 
      generated by the other language. The implementation of LiveConnect 
      exception handling now makes graceful error recovery between the two 
      languages possible.</p>

    <p><b>Get there quick:</b>
    <ul>
      <li><a href="#jexception">Catching Java exceptions in JavaScript</a></li>
      <li><a href="#jsexception">Catching JavaScript exceptions in Java</a></li>
      <li><a href="#examples">Examples</a><ul>
	  <li><a href="#troubleshooting">Troubleshooting</a></li>
	</ul>
      </li>
    </ul>
  </p>

    <hr size="5" width="90%">

    <p><b><font size="+1"><a name="jexception">Catching Java exceptions in JavaScript</a></font></b></p>
    <p><dl>
      <dd>Java exceptions are throw back into JavaScript when a line of 
	JavaScript code tries to access a Java member variable or method
	and fails.</p>

	<p><dd>eg. the following example JavaScript code...<br>
	<code><pre>try {
        java.lang.Class.forName("blah");
} catch (e) {
        print("Java Exception caught: " + e);
}
        </pre></code></p>
	<p><dd>...would catch something like this:</p>
	<p><dd><code>Java Exception caught: java.lang.ClassNotFoundException: 
blah</code></p>
    </dl>

    <hr size="5" width="90%">

    <p><b><font size="+1"><a name="jsexception">Catching JavaScript exceptions in Java</a></font></b></p>
    <p><dl>
      <dd>There are two instances where this might occur:</p>

	<ol>
	  <p><li>A Java object successfully evaluates a line of Javascript 
	    code that contains a catch() clause that is activated by 
	    JavaScript code. In this case, a simple JSException is created 
	    and passed back to Java. This JSException contains all the 
	    information relevant to the exception.</p>
	  <p><li>A Java object attempts to evaluate a line of Javascript, 
	    but fails for some reason (syntax, etc.). In this case, the Java 
	    exception that is generated is wrapped in an <em>native 
	    jobject</em> while in JavaScript and is unwrapped as the
	    original Java exception once it is passed back into Java. </p>
	</ol>
      <p><dd>Both of these types of exceptions can be caught in the same way:</p>
	<p><dd>eg. the following example Java code...<br>
	<code><pre>try {
	obj.eval(code);
} catch (JSException e) {
	if (e.getWrappedException() == null)
                return e;
        return e.getWrappedException();
}
        </pre></code></p>
	<p><dd>...would catch something like this...</p>
	<p><dd><code>java.lang.UnsatisfiedLinkError: eval</code></p>
	<p><dd>...depending on the 'code' it was passed.</p>
	
    </dl></p>

    <hr size="5" width="90%">

    <p><b><font size="+1"><a name="examples">Examples</a></font></b></p>
    <p><dl>
      <dd>The following two files can be used to test the various features 
	of LiveConnect exception handling.</p>
	<p><dd><b>Download:</b> (Use RightClick-"Save Link As...")</p>
	<p><dl>
	  <dd><a href="./test.js">test.js</a>
	  <dd><a href="./Test.java">Test.java</a></p>
	</dl></p>
	<p><dd>Below is a listing of both files, followed by a listing of
	the output generated when the files are run through the LiveConnect
	engine (jsj).
    </dl></p>

    <p><table width="300" 
	border="1" 
	cellpadding="5" 
	cellspacing="5" 
	rows="4" 
	cols="1">
	<tr bgcolor="#BCC0D3">
	  <td>
	    <strong>test.js</strong>
	  </td>
	</tr>
	<tr>
	  <td>
	    <code><pre>
try {
        supermario();
} catch (e) {
        print("JS Exception caught: " + e);
}

try {
        java.lang.Class.forName("blah");
} catch (e) {
        print("Java Exception caught: " + e);
}

try {
        str = Packages.Test.doit(this, "throw 'foo';", true);
        print(str);
} catch (e) {
        print("Wrapped Exception caught: " + e);
}
	    </pre></code>
	  </td>
	</tr>
	<tr bgcolor="#BCC0D3">
	  <td>
	    <strong>Test.java</strong>
	  </td>
	</tr>
	<tr>
	  <td>
	    <code><pre>
import netscape.javascript.JSObject;
import netscape.javascript.JSException;

public class Test {

    public static Object doit(JSObject obj, String code, boolean catchit) {
        if (catchit) {
            try {
                obj.eval(code);
            } catch (JSException e) {
	        if (e.getWrappedException() == null)
                        return e;
                return e.getWrappedException(); 
            }
        } else {
            obj.eval(code);
        }
        return null;
    }
}
	    </pre></code>
	  </td>
	</tr>
	<tr bgcolor="#BCC0D3">
	  <td>
	    <strong>Output:</strong>
	  </td>
	</tr>
	<tr>
	  <td>
	    <code><pre>

[user@host liveconnect]$ Linux_All_DBG.OBJ/jsj test.js<font color="#FF6666">
JS Exception caught: ReferenceError:test.js:2: supermario is not defined
Java Exception caught: java.lang.ClassNotFoundException: blah
Wrapped Exception caught: java.lang.UnsatisfiedLinkError: eval</font>
[user@host liveconnect]$</pre></code>
	  </td>
	</tr>
      </table></p>	  
    

    <p><b><font size="+1"><a name="troubleshooting">Troubleshooting</a></font></b></p>
    <p><ul>
      <li>make sure your source tree, specifically the LiveConnect engine 
	and source, are up to date
      <li>make sure your netscape.javascript classes are up to date, compiled,
	and in your $CLASSPATH
      <li>make sure Test.java is compiled and in your $CLASSPATH
    </ul></p>

    <hr>
    <address><a href="mailto:coop@netscape.com">Chris Cooper</a></address>
<!-- Created: Fri Oct  9 14:28:41 EDT 1998 -->
<!-- hhmts start -->
Last modified: Fri Oct  9 17:22:31 EDT 1998
<!-- hhmts end -->
  



<P><BR>
</TD>


<TD VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

</TR>
<TR>


<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=BOTTOM><IMG ALT=""
SRC="../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>
</TR>

<TR>

<TD BGCOLOR="#000000" COLSPAN=6><BR></TD>

<TD BGCOLOR="#000000" VALIGN=TOP>

<FONT COLOR="#AAAAAA" SIZE="-1">
Copyright &copy; 1998 The Mozilla Organization.
</FONT>
</FONT>
</TD>

<TD BGCOLOR="#000000" COLSPAN=2><BR></TD>
</TR>

</TABLE>
<P>
</BODY>
</HTML>
