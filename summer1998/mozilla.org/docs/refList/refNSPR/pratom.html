<HTML>
<HEAD>
<TITLE>NSPR 2.0: Atomic Operations</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT=0 MARGINWIDTH=0>

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP ROWSPAN=2><IMG
SRC="../../../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH=600 HEIGHT=58 VSPACE=0 HSPACE=0></TD></TR></TABLE>
<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR>


<TD BGCOLOR="#000000" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=TOP><IMG ALT=""
SRC="../../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ROWSPAN=2>

<BR><TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../..//"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../mission.html"> Our Mission</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../about.html"> Who We Are</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../get-involved.html"> Getting Involved</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../community.html"> Community</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../advocacy.html"> Editorials</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../news.html"> What's New</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../../development.html"><B> Development</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../blue-sky/"> Blue Sky</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../projects.html"> Projects</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../../source-code.html"><B> Source Code</B></A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../source.html"> Getting It</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../docs/"> Documentation</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../NPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=18><A HREF="../../../bugs/"> Bugs</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=20><B></B></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../../search"><B> Search</B></A></TD></TR>
<TR><TD VALIGN=TOP><IMG SRC="../../../images/bullet1.gif" ALT="" WIDTH=8 HEIGHT=8 HSPACE=2 VSPACE=3></TD><TD NOWRAP COLSPAN=19><A HREF="../../../feedback.html"><B> Feedback</B></A></TD></TR>
</TABLE><BR>

</TD>


<TD BGCOLOR="#DDDDDD" VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=TOP><IMG ALT=""
SRC="../../../images/curve1.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=TOP ROWSPAN=2>
<P><BR>







<A HREF="contents.html">[Contents]</A> <A HREF="prntdb.html">[Previous]</A> <A HREF="prinrvl.html">[Next]</A> <A HREF="last.html">[Last]</A>
<HR>
<A NAME="1018510">
<P></A><CENTER><H2>Chapter 12<BR><A NAME="1018543">
Atomic Operations</H2>
</A></CENTER>
<A NAME="1019245">
This chapter describes the global functions you use to perform atomic operations. The functions define a portable API that may be reliably used in any environment. Since not all operating environments provide access to such functions, their performance may vary considerably. <P></A>

<A NAME="Atomic Operations Functions"></A>
<A NAME="1019079">
<H2> Atomic Operations Functions</H2>
</A>
<A NAME="1019878">
The API defined for the atomic functions is consistent across all supported platforms. However, the implementation may vary greatly, and hence the performance. On systems that do not provide direct access to atomic operators, NSPR emulates the capabilities by using its own locking mechanisms. For such systems, NSPR performs atomic operations just as efficiently as the client could. Therefore, to preserve portability, it is recommended that clients use the NSPR API for atomic operations.<P></A>
<A NAME="1019941">
<A HREF="pratom.html#1007459"><CODE>PR_AtomicIncrement</CODE></A><br><A HREF="pratom.html#1018921"><CODE>PR_AtomicDecrement</CODE></A><br><A HREF="pratom.html#1018974"><CODE>PR_AtomicSet</CODE></A><P></A>

<A NAME="Head3;"></A>
<A NAME="1007459">
<H4> PR_AtomicIncrement</H4>
</A>

<A NAME="1007460">
Atomically increments a 32-bit value.<P></A>
<A NAME="Head4;"></A>
<A NAME="1007471">
<H5> Syntax</H5>
</A>

<A NAME="1018719">
<PRE>#include &lt;pratom.h&gt; </PRE></A><A NAME="1018720">
<PRE>PRInt32 PR_AtomicIncrement(PRInt32 *val);</PRE></A><A NAME="Head4;"></A>
<A NAME="1018721">
<H5> Parameter</H5>
</A>

<A NAME="1009456">
The function has the following parameter:<P><B></B>
<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><A NAME="1009798">
<PRE>val</PRE></A><TD VALIGN=baseline ALIGN=left><A NAME="1009800">
A pointer to the value to increment.</A></P>

</TABLE>
<TABLE>
<TR><TD>
</TABLE>
<P></A>
<A NAME="Head4;"></A>
<A NAME="1009457">
<H5> Returns</H5>
</A>

<A NAME="1019495">
The function returns a value of the field <I>after </I> it was incremented
(<I>i.e.</I>, the result)<P></A>
<A NAME="Head4;"></A>
<A NAME="1007477">
<H5> Description</H5>
</A>

<A NAME="1019770">
The referenced variable is incremented by one. The result of the function is the
value of the memory after the operation. The writing of the memory is unconditional.<P></A>

<A NAME="Head3;"></A>
<A NAME="1018921">
<H4> PR_AtomicDecrement</H4>
</A>

<A NAME="1018922">
Atomically decrements a 32-bit value.<P></A>
<A NAME="Head4;"></A>
<A NAME="1018924">
<H5> Syntax</H5>
</A>

<A NAME="1018925">
<PRE>#include &lt;pratom.h&gt; </PRE></A><A NAME="1018926">
<PRE>PRInt32 PR_AtomicDecrement(PRInt32 *val);</PRE></A><A NAME="Head4;"></A>
<A NAME="1018927">
<H5> Parameter</H5>
</A>

<A NAME="1018933">
The function has the following parameter:<P><B></B>
<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><A NAME="1018930">
<PRE>val</PRE></A><TD VALIGN=baseline ALIGN=left><A NAME="1018932">
A pointer to the value to decrement.</A></P>

</TABLE>
<TABLE>
<TR><TD>
</TABLE>
<P></A>
<A NAME="Head4;"></A>
<A NAME="1018934">
<H5> Returns</H5>
</A>

<A NAME="1018935">
The function returns a value of the memory <I>after</I> the decrement,
(<I>i.e.</I>, the result).<P></A>
<A NAME="Head4;"></A>
<A NAME="1018936">
<H5> Description</H5>
</A>

<A NAME="1019589">
<CODE>PR_AtomicDecrement</CODE> first decrements the referenced variable by one.
The value returned is the referenced variable's final value. The modification
to memory is unconditional.<P></A>

<A NAME="Head3;"></A>
<A NAME="1018974">
<H4> PR_AtomicSet</H4>
</A>

<A NAME="1019660">
Atomically sets a 32-bit value and return its previous contents.<P></A>
<A NAME="Head4;"></A>
<A NAME="1018977">
<H5> Syntax</H5>
</A>

<A NAME="1018978">
<PRE>#include &lt;pratom.h&gt; </PRE></A><A NAME="1018979">
<PRE>PRInt32 PR_AtomicSet(
    PRInt32 *val,
    PRInt32 newval);
</PRE></A><A NAME="Head4;"></A>
<A NAME="1018980">
<H5> Parameters</H5>
</A>

<A NAME="1018986">
The function has the following parameters:<P><B></B>
<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><A NAME="1018983">
<PRE>val</PRE></A><TD VALIGN=baseline ALIGN=left><A NAME="1018985">
A pointer to the value to be set.</A></P>
<TR><TD VALIGN=baseline ALIGN=left><A NAME="1019020">
<PRE>newval</PRE></A><TD VALIGN=baseline ALIGN=left><A NAME="1019022">
The new value to assign to the <CODE>val</CODE> parameter.</A></P>

</TABLE>
<TABLE>
<TR><TD>
</TABLE>
<P></A>
<A NAME="Head4;"></A>
<A NAME="1018987">
<H5> Returns</H5>
</A>

<A NAME="1018988">
The function returns the prior value of the referenced variable.<P></A>
<A NAME="Head4;"></A>
<A NAME="1018989">
<H5> Description</H5>
</A>

<A NAME="1019736">
<CODE>PR_AtomicSet</CODE> first reads the value of var, then updates it with the supplied value. The returned value is the value that was read <I>before</I> memory was updated. The memory modification is unconditional--that is, it is not a test and set operation.<P></A>

<P><HR>
<A HREF="contents.html">[Contents]</A> <A HREF="prntdb.html">[Previous]</A> <A HREF="prinrvl.html">[Next]</A> <A HREF="last.html">[Last]</A>
<P ALIGN=right>

<FONT SIZE=-2><I>Last Updated: Mon Jul 13 18:15:01 PDT 1998</I></FONT>

<HR SIZE=4>

<P> <CENTER>Copyright © 1998
<A HREF="http://home.netscape.com/misc/contact_info.html"
TARGET=_top>Netscape Communications Corporation</A></FONT>
</CENTER>
<P>
<P>






<P><BR>
</TD>


<TD VALIGN=TOP ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/curve3.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=TOP><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

</TR>
<TR>


<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM><IMG ALT=""
SRC="../../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#DDDDDD" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD VALIGN=BOTTOM><IMG ALT=""
SRC="../../../images/curve2.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>


<TD VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/curve4.gif"
WIDTH=16 HEIGHT=16 HSPACE=0 VSPACE=0></TD>

<TD BGCOLOR="#000000" VALIGN=BOTTOM ALIGN=RIGHT><IMG ALT=""
SRC="../../../images/bit.gif"
WIDTH=4 HEIGHT=16 HSPACE=0 VSPACE=0></TD>
</TR>

<TR>

<TD BGCOLOR="#000000" COLSPAN=6><BR></TD>

<TD BGCOLOR="#000000" VALIGN=TOP>

<FONT COLOR="#AAAAAA" SIZE="-1">
Copyright &copy; 1998 Netscape Communications Corporation.
</FONT>
</FONT>
</TD>

<TD BGCOLOR="#000000" COLSPAN=2><BR></TD>
</TR>

</TABLE>
<P>
</BODY>
</HTML>
