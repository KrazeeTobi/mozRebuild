<HTML>
<HEAD>
<TITLE>libmime</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"
LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000"
MARGINHEIGHT="0" MARGINWIDTH="0">

<MAP NAME="banner">
<AREA SHAPE=RECT COORDS="300,11,558,44" ALT="" HREF="http://www.mozilla.org/">
</MAP>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH="100%">
<TR><TD BGCOLOR="#000000" VALIGN=TOP><IMG
SRC="../images/mozilla-banner.gif"
ALT="" BORDER=0 USEMAP="#banner"
WIDTH="600" HEIGHT="58" VSPACE="0" HSPACE="0"></TD></TR></TABLE>

<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">


<TR>


<TD VALIGN="TOP" >
<TABLE BORDER="0" ><TR><TD BGCOLOR="#000000" VALIGN="TOP">
<TABLE BORDER="0" CELLSPACING="3"><TR><TD BGCOLOR="#DDDDDD" VALIGN="TOP">
<TABLE CELLPADDING=0 CELLSPACING=3 BORDER=0>
<TR><TD NOWRAP COLSPAN=2><A HREF=".././"><B> The Mozilla<BR>Organization</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../mozorg.html"> At A Glance</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../feedback.html"> Feedback</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../get-involved.html"> Get Involved</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../community.html"> Newsgroups</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../MPL/"> License Terms</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://www.mozilla.org/newsbot/"> Newsbot</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../docs/"><B> Developer Docs</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../roadmap.html"> Roadmap</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../projects/"> Projects</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../ports/"> Ports</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../owners.html"> Module Owners</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../hacking/"> Hacking</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../source.html"> Get the Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../build/"> Build It</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../quality/"><B> Testing</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../binaries.html"> Download</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../bugs/"> Bugzilla</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="../quality/bug-writing-guidelines.html"> Bug Writing</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../tools.html"><B> Tools</B></A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://lxr.mozilla.org/seamonkey/"> View Source</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://tinderbox.mozilla.org/showbuilds.cgi?tree=SeaMonkey"> Tree Status</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://cvs-mirror.mozilla.org/webtools/bonsai/cvsquery.cgi?treeid=default&amp;module=SeaMonkeyAll&amp;branch=HEAD&amp;branchtype=match&amp;dir=&amp;file=&amp;filetype=match&amp;who=&amp;whotype=match&amp;sortby=Date&amp;hours=2&amp;date=day&amp;mindate=&amp;maxdate=&amp;cvsroot=%2Fcvsroot"> New Checkins</A></TD></TR>
<TR><TD></TD><TD NOWRAP><A HREF="http://bugzilla.mozilla.org/"> Submit A Bug</A></TD></TR>
<TR><TD NOWRAP VALIGN=TOP COLSPAN=3 - 1><B></B></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="../faq.html"><B> FAQ</B></A></TD></TR>
<TR><TD NOWRAP COLSPAN=2><A HREF="http://www.mozilla.org/search.html"><B> Search</B></A></TD></TR>
</TABLE>
</TD></TR></TABLE>
</TD></TR></TABLE>
</TD>


<TD VALIGN="TOP">





<center><b><font color="#000000"><font size=+2>libmime Description</font></font></b>
<br><b><font color="#000000">by Richard H. Pizzarro &lt;<a href="mailto:rhp@netscape.com">rhp@netscape.com</a>></font></b></center>
<b><font color="#000000"></font></b>
<p>This module, libmime, implements a general-purpose MIME parser. One
of the methods provided by this parser is the ability to emit an HTML representation
of the data stream.
<p>The parser is object-oriented. There is a class for each MIME type,
and each class is responsible for parsing itself, and/or handing the input
data off to one of its child objects.
<p>The definition of these classes is somewhat idiosyncratic and consists
of an internally defined object system, instead of C++.
<p>There is one header file and one source file for each class (for example,
the&nbsp; MimeInlineText class is defined in "mimetext.h" and "mimetext.c".)
Each header&nbsp; file follows the following boiler-plate form:
<p><b><font size=+1>typedefs</font></b>
<br>These come first to avoid circular dependencies.
<p><tt>&nbsp;&nbsp;&nbsp; typedef struct FoobarClass FoobarClass;</tt>
<br><tt>&nbsp;&nbsp;&nbsp; typedef struct Foobar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Foobar;</tt>
<p><b><font size=+1>Class Declaration</font></b>
<br>Theis structure defines the callback routines and other per-class data
of the class defined in this module.
<p><tt>&nbsp;&nbsp;&nbsp; struct FoobarClass {</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ParentClass superclass;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...any callbacks or class-variables...</tt>
<br><tt>&nbsp;&nbsp;&nbsp; };</tt>
<p><b><font size=+1>Class Definition</font></b>
<br>This variable holds an instance of the one-and-only class record; the
various instances of this class point to this object.&nbsp; (One interrogates
the type of an instance by comparing the value of its class pointer with
the address of this variable.)
<p><tt>&nbsp;&nbsp;&nbsp; extern FoobarClass foobarClass;</tt>
<p><b><font size=+1>Instance Declaration</font></b>
<br>Theis structure defines the per-instance data of an object, and a pointer
to the corresponding class record.
<p><tt>&nbsp;&nbsp;&nbsp; struct Foobar {</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Parent parent;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...any instance variables...</tt>
<br><tt>&nbsp;&nbsp;&nbsp; };</tt>
<p>Then, in the corresponding .c file, the following structure is used:
<p><b><font size=+1>Class Definition</font></b>
<br>First we pull in the appropriate include file (which includes all necessary
include files for the parent classes) and then we define the class object
using the MimeDefClass macro:
<p><tt>&nbsp;&nbsp;&nbsp; #include "foobar.h"</tt>
<br><tt>&nbsp;&nbsp;&nbsp; #define MIME_SUPERCLASS parentlClass</tt>
<br><tt>&nbsp;&nbsp;&nbsp; MimeDefClass(Foobar, FoobarClass, foobarClass,
&amp;MIME_SUPERCLASS);</tt>
<p>The definition of MIME_SUPERCLASS is just to move most of the knowlege
of the exact class hierarchy up to the file's header, instead of it being
scattered through the various methods; see below.
<p><b><font size=+1>Method Declarations</font></b>
<br>We will be putting function pointers into the class object, so we declare
them here.&nbsp; They can generally all be static, since nobody outside
of this file needs to reference them by name; all references to these routines
should be through the class object.
<p><tt>&nbsp;&nbsp;&nbsp; extern int FoobarMethod(Foobar *);</tt>
<br><tt>&nbsp;&nbsp;&nbsp; ...etc...</tt>
<p><b><font size=+1>Class Initialization Function</font></b>
<br>The MimeDefClass macro expects us to define a function which will finish
up any initialization of the class object that needs to happen before the
first time it is instantiated.&nbsp; Its name must be of the form "&lt;class>Initialize",
and it should initialize the various method slots in the class as appropriate.&nbsp;
Any methods or class variables which this class does not wish to override
will be automatically inherited from the parent class (by virtue of its
class-initialization function having been run first.)&nbsp; Each class
object will only be initialized once.
<p><tt>&nbsp;&nbsp;&nbsp; static int</tt>
<br><tt>&nbsp;&nbsp;&nbsp; FoobarClassInitialize(FoobarClass *class)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; {</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class->method = FoobarMethod.</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...etc...</tt>
<br><tt>&nbsp;&nbsp;&nbsp; }</tt>
<p><b><font size=+1>Method Definitions</font></b>
<br>Next come the definitions of the methods we referred to in the class-init
function.&nbsp; The way to access earlier methods (methods defined on the
superclass) is to simply extract them from the superclass's object. But
note that you CANNOT get at methods by indirecting through object->class->superclass:
that will only work to one level, and will go into a loop if some subclass
tries to continue on this method.
<p>The easiest way to do this is to make use of the MIME_SUPERCLASS macro
that was defined at the top of the file, as shown below.&nbsp; The alternative
to that involves typing the literal name of the direct superclass of the
class defined in this file, which will be a maintenance headache if the
class hierarchy changes.&nbsp; If you use the MIME_SUPERCLASS idiom, then
a textual change is required in only one place if this class's superclass
changes.
<p><tt>&nbsp;&nbsp;&nbsp; static void</tt>
<br><tt>&nbsp;&nbsp;&nbsp; Foobar_finalize (MimeObject *object)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; {</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((MimeObjectClass*)&amp;MIME_SUPERCLASS)->finalize(object);&nbsp;
//&nbsp; RIGHT</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parentClass.whatnot.object.finalize(object);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//&nbsp; (works...)</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object->class->superclass->finalize(object);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//&nbsp; WRONG!!</tt>
<br><tt>&nbsp;&nbsp;&nbsp; }</tt>
<p>The class hierarchy is:
<p><tt>&nbsp;&nbsp; MimeObject (abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |--- MimeContainer (abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeMultipart
(abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartMixed</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartDigest</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartParallel</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartAlternative</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartRelated</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartAppleDouble</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeSunAttachment</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeMultipartSigned (abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeMessage</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeUntypedText</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |--- MimeLeaf (abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeInlineText
(abstract)</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeInlineTextPlain</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeInlineTextHTML</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|--- MimeInlineTextRichtext</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;
|&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeInlineTextEnriched</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |---
MimeInlineTextVCard</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |---
MimeInlineTextCalendar</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeInlineImage</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; |--- MimeExternalObject</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; |--- MimeExternalBody</tt>
<br><tt></tt>&nbsp;




</TD>

</TR>
<TR>

<TD COLSPAN="2" ALIGN="RIGHT" VALIGN="TOP">
<FONT SIZE="-1">
Copyright &copy; 1998-2000 The Mozilla Organization.
<BR>
<A HREF="http://www.mozilla.org/webtools/bonsai/cvslog.cgi?file=mozilla-org/html/mailnews/libmime-description.html&amp;rev=&amp;root=/cvsroot/">Last modified January 26,  1999</A>.
</FONT>
</TD>
</TR>

</TABLE>
</BODY>
</HTML>
